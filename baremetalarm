#!/bin/bash
FLAGS=IOAcc,LLVMGEP,LLVMInterface,CommInterface,LLVMRuntime,-LLVMParse,Interrupt
if [ "$1" != "" ]; then
    BENCH=$1
else
    echo "No benchmark specified. Using vadd."
    BENCH="vadd"
fi
KERNEL=$M5_PATH/benchmarks/$BENCH/host/main.elf
SYS_OPTS="--mem-size=4GB \
          --kernel=$KERNEL \
          --disk-image=$M5_PATH/baremetal/common/fake.iso \
          --machine-type=VExpress_GEM5_V1 \
          --dtb-file=none --bare-metal \
          --cpu-type=TimingSimpleCPU"
CACHE_OPTS="--acc_cache"
# Script to start up full system simulation
build/ARM/gem5.opt --debug-flags=$FLAGS --outdir=BM_ARM_OUT configs/example/fs.py \
$SYS_OPTS --accpath=$M5_PATH/benchmarks --accbench=$BENCH \
$CACHE_OPTS > BM_ARM_OUT/debug_trace.txt
